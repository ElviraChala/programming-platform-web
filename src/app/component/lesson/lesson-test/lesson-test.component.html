<div *ngIf="student && questions.length > 0" class="test-container">
  <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ -->
  <h1 class="test-title">–¢–µ—Å—Ç –¥–æ —É—Ä–æ–∫—É üìö</h1>

  <!-- –ù–∞–≤—ñ–≥–∞—Ü—ñ—è –ø–æ –∑–∞–ø–∏—Ç–∞–Ω–Ω—è—Ö -->
  <div *ngIf="!showResults && currentQuestionIndex < questions.length" class="navigation-panel">
    <div class="question-buttons">
      <button
        *ngFor="let question of questions; let i = index"
        [class.current]="i === currentQuestionIndex"
        [class.answered]="isAnswers[i]"
        [class.unanswered]="!isAnswers[i]"
        (click)="goToQuestion(i)">
        {{ i + 1 }}
      </button>
    </div>
  </div>

  <!-- –ü–æ—Ç–æ—á–Ω–µ –ø–∏—Ç–∞–Ω–Ω—è -->
  <div *ngIf="!showResults && currentQuestionIndex < questions.length" class="question-container">
    <h2 class="question-number">–ó–∞–ø–∏—Ç–∞–Ω–Ω—è {{ currentQuestionIndex + 1 }}:</h2>
    <app-question
      [idQuestion]="currentQuestionId"
      [(ngModel)]="currentAnswer">
    </app-question>

    <!-- –ù–∞–≤—ñ–≥–∞—Ü—ñ–π–Ω—ñ –∫–Ω–æ–ø–∫–∏ -->
    <div class="navigation-buttons">
      <button
        class="nav-button"
        (click)="previousQuestion()"
        [disabled]="currentQuestionIndex === 0">
        ‚Üê –ü–æ–ø–µ—Ä–µ–¥–Ω—î
      </button>

      <button
        class="answer-button"
        (click)="getAnswer()"
        [disabled]="!currentAnswer.trim()">
        {{ currentQuestionIndex + 1 === questions.length ? '–ó–∞–≤–µ—Ä—à–∏—Ç–∏' : '–í—ñ–¥–ø–æ–≤—ñ—Å—Ç–∏' }}
      </button>

      <button
        class="nav-button"
        (click)="nextQuestion()"
        [disabled]="currentQuestionIndex === questions.length - 1">
        –ù–∞—Å—Ç—É–ø–Ω–µ ‚Üí
      </button>
    </div>

    <!-- –ù–∞–≤—ñ–≥–∞—Ü—ñ–π–Ω–∏–π –±–ª–æ–∫ -->
    <button class="return-button" (click)="goBackToLesson()">
      –ü–æ–≤–µ—Ä–Ω—É—Ç–∏—Å—å –¥–æ —É—Ä–æ–∫—É
    </button>
  </div>

  <!-- –ó–∞–≤–µ—Ä—à–µ–Ω–Ω—è —Ç–µ—Å—Ç—É -->
  <div *ngIf="!showResults && currentQuestionIndex >= questions.length" class="test-completion">
    <h2 class="completion-title">–¢–µ—Å—Ç –∑–∞–≤–µ—Ä—à–µ–Ω–æ!</h2>
    <button class="submit-button" (click)="submitAnswers()">–ù–∞–¥—ñ—Å–ª–∞—Ç–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ</button>
  </div>

  <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç–∏ -->
  <div *ngIf="showResults" class="result-container">
    <div class="result-content">
      <h2 class="result-score">–í–∞—à —Ä–µ–∑—É–ª—å—Ç–∞—Ç: {{ resultScore | number:'1.0-0' }} —ñ–∑ {{ total }}</h2>
      <p class="feedback-message">{{ feedbackMessage }}</p>
      <div class="navigation-block">
        <h4 class="navigation-title">–ù–∞–≤—ñ–≥–∞—Ü—ñ—è:</h4>
        <div class="result-buttons">
          <button class="go-to-course" (click)="goBackToLesson()">
            –ü–æ–≤–µ—Ä–Ω—É—Ç–∏—Å—å –¥–æ —É—Ä–æ–∫—É
          </button>
          <button class="go-to-coding" (click)="goToCodingTasks()">
            –ü–µ—Ä–µ–π—Ç–∏ –¥–æ –ø—Ä–∞–∫—Ç–∏—á–Ω–∏—Ö –∑–∞–≤–¥–∞–Ω—å üíª
          </button>
          <!-- –ö–Ω–æ–ø–∫–∞ –¥–æ –Ω–∞—Å—Ç—É–ø–Ω–æ–≥–æ —É—Ä–æ–∫—É –∞–±–æ –ø–æ–≤–µ—Ä–Ω–µ–Ω–Ω—è –¥–æ –∫—É—Ä—Å—ñ–≤ -->
          <button *ngIf="isCheckKnowledgeCompleted && isProgrammingTaskCompleted && nextLesson"
                  class="go-to-next-lesson" (click)="goToNextLesson()">
            –ü–µ—Ä–µ–π—Ç–∏ –¥–æ –Ω–∞—Å—Ç—É–ø–Ω–æ–≥–æ —É—Ä–æ–∫—É
          </button>
          <button *ngIf="isCheckKnowledgeCompleted && isProgrammingTaskCompleted && !nextLesson"
                  class="go-to-courses" (click)="goToCourseList()">
            –ü–æ–≤–µ—Ä–Ω—É—Ç–∏—Å—è –¥–æ —Å–ø–∏—Å–∫—É –∫—É—Ä—Å—ñ–≤
          </button>
        </div>
      </div>
    </div>
    <img class="result-image" src="/img-result.png" alt="Result Illustration">
  </div>
</div>
